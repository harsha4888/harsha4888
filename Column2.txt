Quarter1 = 
IF(
    [date_filtered] = 0,
    YEAR('Viz Expenses'[Created Date]) & "Q" & QUARTER('Viz Expenses'[Created Date]),
    IF(
        [date_filtered] = 1,
        YEAR('Viz Expenses'[Payment Date]) & "Q" & QUARTER('Viz Expenses'[Payment Date]),
        YEAR('Viz Expenses'[Transaction Date]) & "Q" & QUARTER('Viz Expenses'[Transaction Date])
    )
)

Quarter1 Rank = 
RANKX(
    ALL('Viz Expenses'[Quarter1]), 
    'Viz Expenses'[Quarter1], 
    , 
    ASC, 
    Skip
)


Current or Last Quarter = 
VAR MaxQuarter = MAXX(ALL('Viz Expenses'), 'Viz Expenses'[Quarter1])
VAR LastQuarter = MaxQuarter - 1
RETURN
    IF(
        'Viz Expenses'[Quarter1] = MaxQuarter, 
        "Current Quarter",
        IF(
            'Viz Expenses'[Quarter1] = LastQuarter, 
            "Last Quarter", 
            BLANK()
        )
    )

Current or Last Quarter Rank = 
SWITCH(
    TRUE(),
    'Viz Expenses'[Current or Last Quarter] = "Current Quarter", 1,
    'Viz Expenses'[Current or Last Quarter] = "Last Quarter", 2,
    BLANK()
)


